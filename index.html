<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS QRコードジェネレーター</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
   
    <!-- head内に追加 -->
    <link rel="manifest" href="manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('./sw.js');
        }
    </script>
    <style>
    /* ======================================= */
    /* 画面中央寄せのための新しいCSS */
    /* ======================================= */

    body {
        font-family: sans-serif;
    
        /* 1. 画面の高さ全体を使えるようにする */
        height: 100vh;
        /* 2. bodyのデフォルトマージンをリセット */
        margin: 0;
        /* 3. Flexboxを有効化（中央寄せの親要素にする） */
        display: flex;
        /* 4. Flexアイテム（body直下の子要素）を垂直方向（上下）に中央寄せ */
        align-items: center;
        /* 5. Flexアイテムを水平方向（左右）に中央寄せ */
        justify-content: center;
    
        /* 6. レイアウトが縦に積み重なるように設定（重要） */
        /* これがないとすべて横一列に並んでしまうため、縦方向の配置に戻す */
        flex-direction: column; 
    }

    /* フォームとQRコードエリアはbodyの中央に配置される */
    #input-area {
        margin-bottom: 30px;
    }

    #text-input {
        width: 80%;
        max-width: 400px;
        padding: 10px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }

    #qrcode-output {
        /* 中央寄せのためにあった margin や display, text-align は不要 */
        margin: 20px auto;
        padding: 10px;
        border: 1px solid #ddd;
        /* 以前の中央寄せCSSは削除 */
        /* display: block; */
        /* text-align: center; */
    }

    /* QRコードライブラリが生成するtable要素の中央寄せ（横方向の調整） */
    #qrcode-output table {
        /* tableを中央に寄せるための定石。Flexbox環境下でも有効 */
        margin-left: auto;
        margin-right: auto;
    }

    /* h1, p, buttonもFlexアイテムになるため、必要に応じてマージンを調整 */
    h1 {
        margin-top: 0;
    }
    </style>
</head>
    
<body>

    <h1>QRコード生成</h1>

    <div id="input-area">
        <p>QRコードにしたいテキストまたはURLを入力してください。</p>
        <input type="text" id="text-input" placeholder="例: https://www.google.com/" value="Hello World!">
    </div>

    <div id="qrcode-output">
        </div>

    <input type="text" id="text-input" autocomplete="off" placeholder="例: https://www.google.com/" value="">
    <div id="qrcode-output"></div>
    <button id="download-btn">ダウンロード</button>
    <script>
        const textInput = document.getElementById('text-input');
        const qrcodeOutput = document.getElementById('qrcode-output');
        const downloadBtn = document.getElementById('download-btn');

        function generateQRCode(text) {
         qrcodeOutput.innerHTML = '';
            if (!text) {
             qrcodeOutput.innerHTML = '<span style="color: #888;">テキストを入力してください</span>';
             return;
         }
            new QRCode(qrcodeOutput, {
                text: text,
                width: 256,
                height: 256,
                colorDark: "#000000",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
         });
        }

        generateQRCode(textInput.value);

        textInput.addEventListener('input', () => {
            generateQRCode(textInput.value);
        });

        downloadBtn.addEventListener('click', () => {
         const img = qrcodeOutput.querySelector('img');
            if (img && img.src) {
             const a = document.createElement('a');
             a.href = img.src;
                a.download = 'qrcode.png';
             a.click();
         }
        });
        </script>
    </body>
</html>

